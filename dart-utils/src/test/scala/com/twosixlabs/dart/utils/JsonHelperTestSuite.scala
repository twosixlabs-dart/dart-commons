package com.twosixlabs.dart.utils

import com.twosixlabs.dart.test.base.ScalaTestBase

class JsonHelperTestSuite extends ScalaTestBase {

    "Json Helper" should "unmarshal a simple Json object as a Map[String, String]" in {
        val json : String = """{ "foo": "bar", "apples": "pears", "happy": "gilmore" }"""
        val expected : Map[ String, String ] = Map( "foo" -> "bar", "apples" -> "pears", "happy" -> "gilmore" )
        val result : Option[ Map[ String, String ] ] = JsonHelper.unmarshalStringMap( json )
        result.get shouldBe expected
    }

    "Json Helper" should "marshal a simple Map[String, String] to json" in {
        val map : Map[ String, String ] = Map( "foo" -> "bar", "apples" -> "pears", "happy" -> "gilmore" )
        val expected : String = """{"foo":"bar","apples":"pears","happy":"gilmore"}"""
        val result : Option[ String ] = JsonHelper.marshalStringMap( map )
        result.get shouldBe expected
    }

    "Json Helper" should "unmarshal a complex Json object as a Map[String, String]" in {
        //@formatter:off
        val json : String = """{"0": "\tAr:ea\t\t\t\t\t\t\t\t\t\t\t\t\tTo,tal\nSub-Basin\t\tJan\tFeb\tMar\tApr\tMay\tJun\tJul\tAug\tSep\tOct\tNov\tDec\t\n\t(km2)\t\t\t\t\t\t\t\t\t\t\t\t\t(mm)\nMain Nile 1\t39.896\t9\t10\t5\t4\t2\t0\t0\t0\t0\t3\t2\t6\t40\nMain Nile 2\t199.564\t2\t2\t2\t2\t2\t0\t0\t0\t0\t0\t1\t2\t13\nMain Nile 3\t743.913\t1\t0\t0\t1\t2\t3\t21\t31\t8\t1\t0\t0\t70\nTekezze-Atbara\t231.492\t3\t2\t9\t20\t31\t58\t150\t155\t74\t19\t3\t2\t524\nMain Nile 4\t35.338\t0\t0\t0\t2\t7\t5\t31\t51\t19\t4\t0\t0\t121\nBlue Nile\t307.262\t6\t11\t22\t36\t87\t138\t231\t225\t140\t63\t14\t6\t978\nLower White Nile\t237.429\t1\t1\t1\t13\t31\t68\t131\t129\t83\t54\t4\t0\t517\nBahr el Ghazal\t549.714\t4\t6\t19\t47\t78\t107\t149\t176\t124\t70\t14\t3\t795\nSudd\t167.354\t8\t12\t32\t76\t118\t135\t148\t160\t137\t103\t32\t7\t968\nBaro-Akobo-Sobat\t230.368\t23\t22\t50\t94\t130\t119\t140\t140\t134\t111\t62\t27\t1051\nAlbert Nile-Bahr al Jabal\t80.432\t18\t41\t79\t126\t143\t98\t119\t132\t140\t114\t75\t36\t1121\nVictoria Nile\t86.192\t39\t65\t111\t142\t134\t68\t92\t105\t131\t123\t98\t58\t1166\nSemliki-L.Albert\t70.646\t55\t90\t121\t109\t99\t50\t54\t93\t122\t120\t118\t64\t1095\nLake Victoria\t191.317\t104\t105\t163\t167\t136\t53\t45\t58\t88\t101\t140\t125\t1285\nKagera\t58.115\t98\t133\t142\t128\t86\t19\t14\t26\t57\t74\t122\t89\t986\n","1": "\tArea\t\t\t\t\t\t\t\t\t\t\t\t\tTotal\nSub-Basin\t\tJan\tFeb\tMar\tApr\tMay\tJun\tJul\tAug\tSep\tOct\tNov\tDec\t\n\t(km2)\t\t\t\t\t\t\t\t\t\t\t\t\t(mm)\nMain Nile 1\t39,896\t13\t21\t36\t49\t46\t60\t76\t75\t45\t24\t15\t11\t472\nMain Nile 2\t199,564\t3\t4\t6\t8\t8\t9\t10\t10\t7\t4\t3\t2\t74\nMain Nile 3\t743,913\t1\t1\t1\t1\t3\t10\t28\t30\t11\t5\t3\t1\t97\nTekezze-Atbara\t231,492\t19\t15\t15\t16\t23\t53\t79\t79\t70\t44\t23\t18\t453\nMain Nile 4\t35,338\t2\t2\t3\t3\t7\t18\t51\t61\t25\t5\t1\t1\t180\nBlue Nile\t307,262\t45\t38\t37\t39\t52\t72\t89\t87\t90\t83\t57\t47\t737\nLower White Nile\t237,429\t35\t29\t25\t22\t34\t62\t95\t100\t80\t64\t38\t34\t617\nBahr el Ghazal\t549,714\t51\t48\t53\t50\t68\t81\t93\t95\t88\t80\t62\t53\t823\nSudd\t167,354\t97\t87\t86\t79\t102\t105\t104\t103\t109\t119\t114\t103\t1,209\nBaro-Akobo-Sobat\t230,368\t87\t70\t65\t70\t82\t82\t86\t82\t92\t106\t99\t91\t1,012\nAlbert Nile-Bahr al Jabal\t80,432\t85\t72\t88\t87\t105\t100\t94\t93\t105\t114\t113\t88\t1,144\nVictoria Nile\t86,192\t93\t77\t90\t89\t91\t85\t82\t84\t90\t101\t99\t86\t1,067\nSemliki-L.Albert\t70,646\t92\t82\t90\t86\t86\t83\t78\t78\t84\t88\t90\t87\t1,023\nLake Victoria\t191,317\t96\t90\t102\t95\t89\t82\t80\t79\t83\t86\t88\t85\t1,056\nKagera\t58,115\t77\t67\t82\t83\t82\t73\t68\t69\t68\t71\t79\t71\t891\n","2": "\tFAO-Nile\t\t\t\tAdjusted SSEBop Model\t\t\nDescription\tArea\tET\tET\tDescription\tArea  ET\tET\tDev\n\t(km2)\t(km3/yr)\t(mm/yr)\t\t(km2) (km3/yr)\t(mm/yr)\t(%)\nMain Nile d/s Atbara\t877,866\t108.8\t124\tMain Nile 1,2,3\t98,3375 105.7\t107\t13.3\nAtbara\t237,044\t94.1\t397\tTekezze-Atbara\t231,492 104.8\t453\t−14.0\nMain Nile d/s Khartoum\t34,523\t7.3\t211\tMain Nile 4\t35,338 6.4\t180\t14.7\nBlue Nile\t308,198\t266.0\t863\tBlue Nile\t307,262 226.4\t737\t14.6\nWhite Nile\t260,943\t144.5\t554\tLower White Nile\t237,429 146.4\t617\t−11.4\nBahr el Ghazal & el Arab\t606,428\t454.1\t749\tBahr el Ghazal - Sudd\t717,069 654.7\t913\t−21.9\nPibor-Akabo-Sobat\t246,779\t223.8\t907\tBaro-Akobo-Sobat\t230,369 233.2\t1012\t−11.6\nBahr el Jebel\t136,400\t163.1\t1,196\tAlbert Nile-Bahr - al Jabal\t80,433 92.0\t1144\t4.3\nKyoga-Albert\t197,253\t221.6\t1,124\tVictoria Nile Semliki - L.Albert\t156,839 164.2\t1047\t6.8\nLake Victoria basin\t264,985\t307.5\t1,160\tLake VictoriaKagera\t249,433 253.8\t1018\t12.3\nTotal and average\t3,170,419\t1990.8\t628\t\t3,229,039 1987.6\t616\t\n","3": "WA+\t\t\t\t\t\t\t\t\tNet\n\tLULC\tArea\tET\tET\tP\tP\tP-ET\tProduction\t\nCode\t\t\t\t\t\t\t\t\tWithdrawals\n\t\t(km2)\t(mm/yr)\t(km3/yr)\t(mm/yr)\t(km3/yr)\t(mm/yr)\t(km3/yr)\t(km3/yr)\nMLU2\tRainfed crops\t380,180\t749\t284.6\t929\t353.3\t181\t68.7\t0\nMLU1\tPlantations\t74,806\t850\t63.6\t1150\t86.0\t300\t22.4\t0\nULU4\tSavannah\t892,666\t846\t755.3\t870\t776.2\t23\t20.9\t0\nULU8\tPastures\t441,240\t423\t186.9\t442\t194.9\t18\t8.1\t0\nMWU17\tWetlands\t10,057\t1040\t10.5\t1092\t11.0\t52\t0.5\t0\nMWU11\tUrban areas\t58\t769\t0.0\t815\t0.0\t46\t0.0\t0\nULU19\tSinks\t987\t297\t0.3\t146\t0.1\t−150\t0.0\t−0,2\nMLU12\tUrban areas\t4740\t473\t2.2\t142\t0.7\t−330\t0.2\t−1,8\nPLU4\tBare land\t196,017\t91\t17.9\t64\t12.6\t−27\t3.8\t−9,1\nMWU6\tReservoirs\t6310\t1566\t9.9\t48\t0.3\t−1518\t0.1\t−9,7\nULU11\tBare land\t679,835\t62\t42.1\t52\t35.4\t−10\t10.6\t−17,3\nMWU1\tIrrigated crops\t54,733\t812\t44.5\t282\t15.5\t−530\t4.6\t−33,6\n\tRivers and\t\t\t\t\t\t\t\t\nULU16\t\t89,489\t1445\t129.3\t1335\t119.4\t−110\t35.8\t−45,7\n\tnatural lakes\t\t\t\t\t\t\t\t\nULU10\tWetlands\t112,648\t1206\t135.9\t960\t108.1\t−247\t32.4\t−60,2\nULU1\tForests\t285,271\t1067\t304.4\t1053\t300.5\t−14\t90.2\t−94,1\nTotal\t\t3,229,039\t\t1987.3\t\t2014.1\t\t298\t−272\n"}"""

        val expected: Map[String, String] = Map[String, String](
            "0" -> "\tAr:ea\t\t\t\t\t\t\t\t\t\t\t\t\tTo,tal\nSub-Basin\t\tJan\tFeb\tMar\tApr\tMay\tJun\tJul\tAug\tSep\tOct\tNov\tDec\t\n\t(km2)\t\t\t\t\t\t\t\t\t\t\t\t\t(mm)\nMain Nile 1\t39.896\t9\t10\t5\t4\t2\t0\t0\t0\t0\t3\t2\t6\t40\nMain Nile 2\t199.564\t2\t2\t2\t2\t2\t0\t0\t0\t0\t0\t1\t2\t13\nMain Nile 3\t743.913\t1\t0\t0\t1\t2\t3\t21\t31\t8\t1\t0\t0\t70\nTekezze-Atbara\t231.492\t3\t2\t9\t20\t31\t58\t150\t155\t74\t19\t3\t2\t524\nMain Nile 4\t35.338\t0\t0\t0\t2\t7\t5\t31\t51\t19\t4\t0\t0\t121\nBlue Nile\t307.262\t6\t11\t22\t36\t87\t138\t231\t225\t140\t63\t14\t6\t978\nLower White Nile\t237.429\t1\t1\t1\t13\t31\t68\t131\t129\t83\t54\t4\t0\t517\nBahr el Ghazal\t549.714\t4\t6\t19\t47\t78\t107\t149\t176\t124\t70\t14\t3\t795\nSudd\t167.354\t8\t12\t32\t76\t118\t135\t148\t160\t137\t103\t32\t7\t968\nBaro-Akobo-Sobat\t230.368\t23\t22\t50\t94\t130\t119\t140\t140\t134\t111\t62\t27\t1051\nAlbert Nile-Bahr al Jabal\t80.432\t18\t41\t79\t126\t143\t98\t119\t132\t140\t114\t75\t36\t1121\nVictoria Nile\t86.192\t39\t65\t111\t142\t134\t68\t92\t105\t131\t123\t98\t58\t1166\nSemliki-L.Albert\t70.646\t55\t90\t121\t109\t99\t50\t54\t93\t122\t120\t118\t64\t1095\nLake Victoria\t191.317\t104\t105\t163\t167\t136\t53\t45\t58\t88\t101\t140\t125\t1285\nKagera\t58.115\t98\t133\t142\t128\t86\t19\t14\t26\t57\t74\t122\t89\t986\n",
            "1" -> "\tArea\t\t\t\t\t\t\t\t\t\t\t\t\tTotal\nSub-Basin\t\tJan\tFeb\tMar\tApr\tMay\tJun\tJul\tAug\tSep\tOct\tNov\tDec\t\n\t(km2)\t\t\t\t\t\t\t\t\t\t\t\t\t(mm)\nMain Nile 1\t39,896\t13\t21\t36\t49\t46\t60\t76\t75\t45\t24\t15\t11\t472\nMain Nile 2\t199,564\t3\t4\t6\t8\t8\t9\t10\t10\t7\t4\t3\t2\t74\nMain Nile 3\t743,913\t1\t1\t1\t1\t3\t10\t28\t30\t11\t5\t3\t1\t97\nTekezze-Atbara\t231,492\t19\t15\t15\t16\t23\t53\t79\t79\t70\t44\t23\t18\t453\nMain Nile 4\t35,338\t2\t2\t3\t3\t7\t18\t51\t61\t25\t5\t1\t1\t180\nBlue Nile\t307,262\t45\t38\t37\t39\t52\t72\t89\t87\t90\t83\t57\t47\t737\nLower White Nile\t237,429\t35\t29\t25\t22\t34\t62\t95\t100\t80\t64\t38\t34\t617\nBahr el Ghazal\t549,714\t51\t48\t53\t50\t68\t81\t93\t95\t88\t80\t62\t53\t823\nSudd\t167,354\t97\t87\t86\t79\t102\t105\t104\t103\t109\t119\t114\t103\t1,209\nBaro-Akobo-Sobat\t230,368\t87\t70\t65\t70\t82\t82\t86\t82\t92\t106\t99\t91\t1,012\nAlbert Nile-Bahr al Jabal\t80,432\t85\t72\t88\t87\t105\t100\t94\t93\t105\t114\t113\t88\t1,144\nVictoria Nile\t86,192\t93\t77\t90\t89\t91\t85\t82\t84\t90\t101\t99\t86\t1,067\nSemliki-L.Albert\t70,646\t92\t82\t90\t86\t86\t83\t78\t78\t84\t88\t90\t87\t1,023\nLake Victoria\t191,317\t96\t90\t102\t95\t89\t82\t80\t79\t83\t86\t88\t85\t1,056\nKagera\t58,115\t77\t67\t82\t83\t82\t73\t68\t69\t68\t71\t79\t71\t891\n",
            "2" -> "\tFAO-Nile\t\t\t\tAdjusted SSEBop Model\t\t\nDescription\tArea\tET\tET\tDescription\tArea  ET\tET\tDev\n\t(km2)\t(km3/yr)\t(mm/yr)\t\t(km2) (km3/yr)\t(mm/yr)\t(%)\nMain Nile d/s Atbara\t877,866\t108.8\t124\tMain Nile 1,2,3\t98,3375 105.7\t107\t13.3\nAtbara\t237,044\t94.1\t397\tTekezze-Atbara\t231,492 104.8\t453\t−14.0\nMain Nile d/s Khartoum\t34,523\t7.3\t211\tMain Nile 4\t35,338 6.4\t180\t14.7\nBlue Nile\t308,198\t266.0\t863\tBlue Nile\t307,262 226.4\t737\t14.6\nWhite Nile\t260,943\t144.5\t554\tLower White Nile\t237,429 146.4\t617\t−11.4\nBahr el Ghazal & el Arab\t606,428\t454.1\t749\tBahr el Ghazal - Sudd\t717,069 654.7\t913\t−21.9\nPibor-Akabo-Sobat\t246,779\t223.8\t907\tBaro-Akobo-Sobat\t230,369 233.2\t1012\t−11.6\nBahr el Jebel\t136,400\t163.1\t1,196\tAlbert Nile-Bahr - al Jabal\t80,433 92.0\t1144\t4.3\nKyoga-Albert\t197,253\t221.6\t1,124\tVictoria Nile Semliki - L.Albert\t156,839 164.2\t1047\t6.8\nLake Victoria basin\t264,985\t307.5\t1,160\tLake VictoriaKagera\t249,433 253.8\t1018\t12.3\nTotal and average\t3,170,419\t1990.8\t628\t\t3,229,039 1987.6\t616\t\n",
            "3" -> "WA+\t\t\t\t\t\t\t\t\tNet\n\tLULC\tArea\tET\tET\tP\tP\tP-ET\tProduction\t\nCode\t\t\t\t\t\t\t\t\tWithdrawals\n\t\t(km2)\t(mm/yr)\t(km3/yr)\t(mm/yr)\t(km3/yr)\t(mm/yr)\t(km3/yr)\t(km3/yr)\nMLU2\tRainfed crops\t380,180\t749\t284.6\t929\t353.3\t181\t68.7\t0\nMLU1\tPlantations\t74,806\t850\t63.6\t1150\t86.0\t300\t22.4\t0\nULU4\tSavannah\t892,666\t846\t755.3\t870\t776.2\t23\t20.9\t0\nULU8\tPastures\t441,240\t423\t186.9\t442\t194.9\t18\t8.1\t0\nMWU17\tWetlands\t10,057\t1040\t10.5\t1092\t11.0\t52\t0.5\t0\nMWU11\tUrban areas\t58\t769\t0.0\t815\t0.0\t46\t0.0\t0\nULU19\tSinks\t987\t297\t0.3\t146\t0.1\t−150\t0.0\t−0,2\nMLU12\tUrban areas\t4740\t473\t2.2\t142\t0.7\t−330\t0.2\t−1,8\nPLU4\tBare land\t196,017\t91\t17.9\t64\t12.6\t−27\t3.8\t−9,1\nMWU6\tReservoirs\t6310\t1566\t9.9\t48\t0.3\t−1518\t0.1\t−9,7\nULU11\tBare land\t679,835\t62\t42.1\t52\t35.4\t−10\t10.6\t−17,3\nMWU1\tIrrigated crops\t54,733\t812\t44.5\t282\t15.5\t−530\t4.6\t−33,6\n\tRivers and\t\t\t\t\t\t\t\t\nULU16\t\t89,489\t1445\t129.3\t1335\t119.4\t−110\t35.8\t−45,7\n\tnatural lakes\t\t\t\t\t\t\t\t\nULU10\tWetlands\t112,648\t1206\t135.9\t960\t108.1\t−247\t32.4\t−60,2\nULU1\tForests\t285,271\t1067\t304.4\t1053\t300.5\t−14\t90.2\t−94,1\nTotal\t\t3,229,039\t\t1987.3\t\t2014.1\t\t298\t−272\n"
        )
        //@formatter:on
        val result = JsonHelper.unmarshalStringMap( json )
        result.get shouldBe expected
    }

    "Json Helper" should "convert a Map of complex strings into json and back without information loss" in {
        val expected : Map[ String, String ] = Map[ String, String ](
                                                                        //@formatter:off
            "0" -> "\tAr:ea\t\t\t\t\t\t\t\t\t\t\t\t\tTo,tal\nSub-Basin\t\tJa:n\tFeb\tMar\tApr\tMay\tJun\tJul\tAu,,g\tSep\tOct\tNov\tDec\t\n\t(km2)\t\t\t\t\t\t\t\t\t\t\t\t\t(mm)\nMain Ni:l,e 1,\t39.8:9,6\t9,\t,1,0,,,\t5\t4\t2\t0\t0\t0\t0\t3\t2\t6\t40\nMain Nile 2\t199.564\t2\t2\t2\t2\t2\t0\t0\t0\t0\t0\t1\t2\t13\nMain Nile 3\t743.913\t1\t0\t0\t1\t2\t3\t21\t31\t8\t1\t0\t0\t70\nTekezze-Atbara\t231.492\t3\t2\t9\t20\t31\t58\t150\t155\t74\t19\t3\t2\t524\nMain Nile 4\t35.338\t0\t0\t0\t2\t7\t5\t31\t51\t19\t4\t0\t0\t121\nBlue Nile\t307.262\t6\t11\t22\t36\t87\t138\t231\t225\t140\t63\t14\t6\t978\nLower White Nile\t237.429\t1\t1\t1\t13\t31\t68\t131\t129\t83\t54\t4\t0\t517\nBahr el Ghazal\t549.714\t4\t6\t19\t47\t78\t107\t149\t176\t124\t70\t14\t3\t795\nSudd\t167.354\t8\t12\t32\t76\t118\t135\t148\t160\t137\t103\t32\t7\t968\nBaro-Akobo-Sobat\t230.368\t23\t22\t50\t94\t130\t119\t140\t140\t134\t111\t62\t27\t1051\nAlbert Nile-Bahr al Jabal\t80.432\t18\t41\t79\t126\t143\t98\t119\t132\t140\t114\t75\t36\t1121\nVictoria Nile\t86.192\t39\t65\t111\t142\t134\t68\t92\t105\t131\t123\t98\t58\t1166\nSemliki-L.Albert\t70.646\t55\t90\t121\t109\t99\t50\t54\t93\t122\t120\t118\t64\t1095\nLake Victoria\t191.317\t104\t105\t163\t167\t136\t53\t45\t58\t88\t101\t140\t125\t1285\nKagera\t58.115\t98\t133\t142\t128\t86\t19\t14\t26\t57\t74\t122\t89\t986\n",
            "1" -> "\tArea\t\t\t\t\t\t\t\t\t\t\t\t\tTotal\nSub-Basin\t\tJan\tFeb\tMar\tApr\tMay\tJun\tJul\tAug\tSep\tOct\tNov\tDec\t\n\t(km2)\t\t\t\t\t\t\t\t\t\t\t\t\t(mm)\nMain Nile 1\t39,896\t13\t21\t36\t49\t46\t60\t76\t75\t45\t24\t15\t11\t472\nMain Nile 2\t199,564\t3\t4\t6\t8\t8\t9\t10\t10\t7\t4\t3\t2\t74\nMain Nile 3\t743,913\t1\t1\t1\t1\t3\t10\t28\t30\t11\t5\t3\t1\t97\nTekezze-Atbara\t231,492\t19\t15\t15\t16\t23\t53\t79\t79\t70\t44\t23\t18\t453\nMain Nile 4\t35,338\t2\t2\t3\t3\t7\t18\t51\t61\t25\t5\t1\t1\t180\nBlue Nile\t307,262\t45\t38\t37\t39\t52\t72\t89\t87\t90\t83\t57\t47\t737\nLower White Nile\t237,429\t35\t29\t25\t22\t34\t62\t95\t100\t80\t64\t38\t34\t617\nBahr el Ghazal\t549,714\t51\t48\t53\t50\t68\t81\t93\t95\t88\t80\t62\t53\t823\nSudd\t167,354\t97\t87\t86\t79\t102\t105\t104\t103\t109\t119\t114\t103\t1,209\nBaro-Akobo-Sobat\t230,368\t87\t70\t65\t70\t82\t82\t86\t82\t92\t106\t99\t91\t1,012\nAlbert Nile-Bahr al Jabal\t80,432\t85\t72\t88\t87\t105\t100\t94\t93\t105\t114\t113\t88\t1,144\nVictoria Nile\t86,192\t93\t77\t90\t89\t91\t85\t82\t84\t90\t101\t99\t86\t1,067\nSemliki-L.Albert\t70,646\t92\t82\t90\t86\t86\t83\t78\t78\t84\t88\t90\t87\t1,023\nLake Victoria\t191,317\t96\t90\t102\t95\t89\t82\t80\t79\t83\t86\t88\t85\t1,056\nKagera\t58,115\t77\t67\t82\t83\t82\t73\t68\t69\t68\t71\t79\t71\t891\n",
            "2" -> "\tFAO-Nile\t\t\t\tAdjusted SSEBop Model\t\t\nDescription\tArea\tET\tET\tDescription\tArea  ET\tET\tDev\n\t(km2)\t(km3/yr)\t(mm/yr)\t\t(km2) (km3/yr)\t(mm/yr)\t(%)\nMain Nile d/s Atbara\t877,866\t108.8\t124\tMain Nile 1,2,3\t98,3375 105.7\t107\t13.3\nAtbara\t237,044\t94.1\t397\tTekezze-Atbara\t231,492 104.8\t453\t−14.0\nMain Nile d/s Khartoum\t34,523\t7.3\t211\tMain Nile 4\t35,338 6.4\t180\t14.7\nBlue Nile\t308,198\t266.0\t863\tBlue Nile\t307,262 226.4\t737\t14.6\nWhite Nile\t260,943\t144.5\t554\tLower White Nile\t237,429 146.4\t617\t−11.4\nBahr el Ghazal & el Arab\t606,428\t454.1\t749\tBahr el Ghazal - Sudd\t717,069 654.7\t913\t−21.9\nPibor-Akabo-Sobat\t246,779\t223.8\t907\tBaro-Akobo-Sobat\t230,369 233.2\t1012\t−11.6\nBahr el Jebel\t136,400\t163.1\t1,196\tAlbert Nile-Bahr - al Jabal\t80,433 92.0\t1144\t4.3\nKyoga-Albert\t197,253\t221.6\t1,124\tVictoria Nile Semliki - L.Albert\t156,839 164.2\t1047\t6.8\nLake Victoria basin\t264,985\t307.5\t1,160\tLake VictoriaKagera\t249,433 253.8\t1018\t12.3\nTotal and average\t3,170,419\t1990.8\t628\t\t3,229,039 1987.6\t616\t\n",
            "3" -> "WA+\t\t\t\t\t\t\t\t\tNet\n\tLULC\tArea\tET\tET\tP\tP\tP-ET\tProduction\t\nCode\t\t\t\t\t\t\t\t\tWithdrawals\n\t\t(km2)\t(mm/yr)\t(km3/yr)\t(mm/yr)\t(km3/yr)\t(mm/yr)\t(km3/yr)\t(km3/yr)\nMLU2\tRainfed crops\t380,180\t749\t284.6\t929\t353.3\t181\t68.7\t0\nMLU1\tPlantations\t74,806\t850\t63.6\t1150\t86.0\t300\t22.4\t0\nULU4\tSavannah\t892,666\t846\t755.3\t870\t776.2\t23\t20.9\t0\nULU8\tPastures\t441,240\t423\t186.9\t442\t194.9\t18\t8.1\t0\nMWU17\tWetlands\t10,057\t1040\t10.5\t1092\t11.0\t52\t0.5\t0\nMWU11\tUrban areas\t58\t769\t0.0\t815\t0.0\t46\t0.0\t0\nULU19\tSinks\t987\t297\t0.3\t146\t0.1\t−150\t0.0\t−0,2\nMLU12\tUrban areas\t4740\t473\t2.2\t142\t0.7\t−330\t0.2\t−1,8\nPLU4\tBare land\t196,017\t91\t17.9\t64\t12.6\t−27\t3.8\t−9,1\nMWU6\tReservoirs\t6310\t1566\t9.9\t48\t0.3\t−1518\t0.1\t−9,7\nULU11\tBare land\t679,835\t62\t42.1\t52\t35.4\t−10\t10.6\t−17,3\nMWU1\tIrrigated crops\t54,733\t812\t44.5\t282\t15.5\t−530\t4.6\t−33,6\n\tRivers and\t\t\t\t\t\t\t\t\nULU16\t\t89,489\t1445\t129.3\t1335\t119.4\t−110\t35.8\t−45,7\n\tnatural lakes\t\t\t\t\t\t\t\t\nULU10\tWetlands\t112,648\t1206\t135.9\t960\t108.1\t−247\t32.4\t−60,2\nULU1\tForests\t285,271\t1067\t304.4\t1053\t300.5\t−14\t90.2\t−94,1\nTotal\t\t3,229,039\t\t1987.3\t\t2014.1\t\t298\t−272\n"
            //@formatter:on
                                                                        )

        val result : Option[ Map[ String, String ] ] = JsonHelper.unmarshalStringMap( JsonHelper.marshalStringMap( expected ).get )
        result.get shouldBe expected
    }

    "Json Helper" should "marshal a null input map as None" in {
        val nullMap : Map[ String, String ] = null
        val result : Option[ String ] = JsonHelper.marshalStringMap( nullMap )
        result shouldBe None
    }

    "Json Helper" should "marshal an empty input map as None" in {
        val emptyMap : Map[ String, String ] = Map()
        val result : Option[ String ] = JsonHelper.marshalStringMap( emptyMap )
        result shouldBe None
    }

    "Json Helper" should "unmarshal an null string as None" in {
        val nullStr : String = null
        val result : Option[ Map[ String, String ] ] = JsonHelper.unmarshalStringMap( nullStr )
        result shouldBe None
    }

    "Json Helper" should "unmarshal an empty string as None" in {
        val emptyString : String = ""
        val result : Option[ Map[ String, String ] ] = JsonHelper.unmarshalStringMap( emptyString )
        result shouldBe None
    }
}